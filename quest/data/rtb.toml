[project]
id = "rtb"
name = "Ride The Bus"
description = "Card game on Plume testnet"
graphqlEndpoint = "https://api.goldsky.com/api/public/project_cmfy6mw327h2401xm82q555dj/subgraphs/rtb/2.0.0/gn"

[[quest]]
id = "win_1_game"
title = "Win 1 Game on RTB"
description = "Win 1 game of Ride The Bus!!"
reward = 1000
type = "singular"
resultField = "player.games"
query = """
query WinOneGame($playerId: ID!) {
  player(id: $playerId) {
    id
    games(where: {rounds_: {roundIndex: 3}, status: CASHED_OUT}) {
      status
    }
  }
}
"""

[quest.condition]
field = "length"
operator = ">="
value = 1

[[quest]]
id = "play_10_games"
title = "Play 10 Games on RTB"
description = "No matter if you win or lose, just play 10 games."
reward = 4000
type = "progress"
resultField = "player.totalGames"
targetValue = 10
query = """
query PlayTenGames($playerId: ID!) {
  player(id: $playerId) {
    totalGames
  }
}
"""

[quest.condition]
field = "totalGames"
operator = ">="
value = 10

[[quest]]
id = "bet_half_xpl"
title = "Bet 0.5 XPL in total"
description = "Bet more than 0.5 XPL in total"
reward = 2000
type = "progress"
resultField = "player.totalWagered"
targetValue = 0.5
query = """
query BetHalfXPL($playerId: ID!) {
  player(id: $playerId) {
    totalWagered
  }
}
"""

[quest.condition]
field = "totalWagered"
operator = ">="
value = 0.5

[[quest]]
id = "cashout_round_2_twice"
title = "Cashout on round 2, 2 times in a row"
description = "Cashout on round 2, 2 times in a row"
reward = 3000
type = "sequential"
resultField = "player.games"
query = """
query CashoutRound2Twice($playerId: ID!) {
  player(id: $playerId) {
    games(where: {status: CASHED_OUT}) {
      status
      playerGameIndex
    }
  }
}
"""

[quest.condition]
field = "status"
operator = "="
value = "CASHED_OUT"

[quest.sequenceCondition]
field = "playerGameIndex"
sequenceLength = 2

[[quest]]
id = "busted_round_2_same_card"
title = "Busted at round 2"
description = "Lose at round 2 by getting the same card"
reward = 500
type = "conditional"
resultField = "player.games"
customValidator = "validateBustedRound2"
query = """
query BustedRound2($playerId: ID!) {
  player(id: $playerId) {
    games(where: {status: BUSTED}) {
      status
      rounds {
        roundIndex
        roundOutcome
      }
    }
  }
}
"""

[[quest.conditions]]
field = "status"
operator = "="
value = "BUSTED"

